<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>基本信息填写</title>
  <style>
    /* 整体页面样式 */
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
    }

    /* 标题样式 */
    h1 {
      color: #333;
    }

    /* 根容器样式，带有边框的区域 */
    #root {
      width: 1000px;
      margin: 50px auto;
      padding: 20px;
      background-color: white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* 表单内标签样式 */
    form label {
      display: block;
      margin-bottom: 10px;
      font-weight: bold;
    }

    /* 表单输入框样式 */
    form input[type="text"]{
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    /* 单选按钮容器样式 */
    #sex {
      margin-bottom: 15px;
    }

    #sex label {
      margin-right: 15px;
    }

    /* 提交按钮样式 */
    form button[type="submit"] {
      background-color: #007BFF;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    form button[type="submit"]:hover {
      background-color: #0056b3;
    }

    /* 返回主界面按钮所在链接样式 */
    a {
      text-decoration: none;
    }

    /* 返回主界面按钮样式 */
    button {
      background-color: #ccc;
      color: #333;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background-color: #aaa;
    }
  </style>
</head>
<body>
<h1 style="text-align: center">基本信息填写</h1>
<div id="root" style="border: 1px solid black">
  <form id="addForm" onsubmit="All(event)">
    <h2>一、评估基本信息表</h2>
    <label for="num">1.评估编号</label>
    <input type="text" id="num" name="num" required>
    <label for="thedate">2.评估日期</label>
    <input type="date" id="thedate" name="thedate" required >
    <label for="reason">3.评估原因</label>
    <div id="reason">
      <label><input type="radio" name="reason" value="接受服务前初评">接受服务前初评</label>
      <label><input type="radio" name="reason" value="接受服务后的常规评估">接受服务后的常规评估</label>
      <label><input type="radio" name="reason" value="状况发生变化后的即时评估">状况发生变化后的即时评估</label>
      <label><input type="radio" name="reason" value="因评估结果有疑问进行的复评">因评估结果有疑问进行的复评</label>
    </div>
    <h2>二、被评估者的基本信息表</h2>
    <label for="name">1.姓名</label>
    <input type="text" id="name" name="name" required>
    <label for="sex">2.性别</label>
    <div id="sex">
      <label><input type="radio" name="sex" value="男">男</label>
      <label><input type="radio" name="sex" value="女">女</label>
    </div>
    <label for="born">3.出生日期</label>
    <input type="text" id="born" name="born" required>
    <label for="idcard">4.身份证号</label>
    <input type="text" id="idcard" name="idcard" required >
    <label for="socialcard">5.社保卡号</label>
    <input type="text" id="socialcard" name="socialcard" required>
    <label for="nation">6.民族</label>
    <input type="text" id="nation" name="nation" required >
    <label for="education">7.文化程度</label>
    <div id="education">
      <label><input type="radio" name="education" value="文盲">文盲</label>
      <label><input type="radio" name="education" value="小学">小学</label>
      <label><input type="radio" name="education" value="初中">初中</label>
      <label><input type="radio" name="education" value="高中/技校/中专">高中/技校/中专</label>
      <label><input type="radio" name="education" value="大学专科及以上">大学专科及以上</label>
      <label><input type="radio" name="education" value="不详">不详</label>
    </div>
    <label for="religion">8.宗教信仰</label>
    <input type="text" id="religion" name="religion" required >
    <label for="marriage">9.婚姻状况</label>
    <div id="marriage">
      <label><input type="radio" name="marriage" value="未婚">未婚</label>
      <label><input type="radio" name="marriage" value="已婚">已婚</label>
      <label><input type="radio" name="marriage" value="丧偶">丧偶</label>
      <label><input type="radio" name="marriage" value="离婚">离婚</label>
      <label><input type="radio" name="marriage" value="未说明的婚姻状况">未说明的婚姻状况</label>
    </div>
    <label for="resident">10.居住情况</label>
    <div id="resident">
      <label><input type="radio" name="resident" value="独居">独居</label>
      <label><input type="radio" name="resident" value="与配偶/伴侣居住">与配偶/伴侣居住</label>
      <label><input type="radio" name="resident" value="与子女居住">与子女居住</label>
      <label><input type="radio" name="resident" value="与父母居住">与父母居住</label>
      <label><input type="radio" name="resident" value="与兄弟姐妹居住">与兄弟姐妹居住</label>
      <label><input type="radio" name="resident" value="与其他亲属居住">与其他亲属居住</label>
      <label><input type="radio" name="resident" value="与非亲属关系的人居住">与非亲属关系的人居住</label>
      <label><input type="radio" name="resident" value="养老机构">养老机构</label>
    </div>
    <label for="medical">11.医疗费用支付方式</label>
    <div id="medical" onsubmit="handleSubmit(event)">
      <label><input type="radio" name="medical" value="城镇职工基本医疗保险" onchange="toggleMedelse()">城镇职工基本医疗保险</label>
      <label><input type="radio" name="medical" value="城镇居民基本医疗保险" onchange="toggleMedelse()">城镇居民基本医疗保险</label>
      <label><input type="radio" name="medical" value="新型农村合作医疗" onchange="toggleMedelse()">新型农村合作医疗</label>
      <label><input type="radio" name="medical" value="贫困救助" onchange="toggleMedelse()">贫困救助</label>
      <label><input type="radio" name="medical" value="商业医疗保险" onchange="toggleMedelse()">商业医疗保险</label>
      <label><input type="radio" name="medical" value="全公费" onchange="toggleMedelse()">全公费</label>
      <label><input type="radio" name="medical" value="全自费" onchange="toggleMedelse()">全自费</label>
      <label><input type="radio" name="medical" value="" onchange="toggleMedelse()">其他</label>
      <label for="medelse">其他请说明：</label>
      <input type="text" id="medelse" name="medelse" disabled required >
    </div>
    <label for="income">12.经济来源</label>
    <div id="income" >
      <label><input type="radio" name="income" value="退休金/养老金" onchange="toggleIncelse()">退休金/养老金</label>
      <label><input type="radio" name="income" value="子女补贴" onchange="toggleIncelse()">子女补贴</label>
      <label><input type="radio" name="income" value="亲友资助" onchange="toggleIncelse()">亲友资助</label>
      <label><input type="radio" name="income" value="其他" onchange="toggleIncelse()">其他补贴</label>
      <label for="incelse">其他请说明：</label>
      <input type="text" id="incelse" name="incelse" disabled required >
    </div>
    <h3>14.根据以下内容填写疾病诊断</h3>
    <label for="stupid">(1)痴呆</label>
    <div id="stupid">
      <label><input type="radio" name="stupid" value="无">无</label>
      <label><input type="radio" name="stupid" value="轻度">轻度</label>
      <label><input type="radio" name="stupid" value="中度">中度</label>
      <label><input type="radio" name="stupid" value="重度">重度</label>
    </div>
    <label for="mentaldis">(2)精神疾病</label>
    <div id="mentaldis">
      <label><input type="radio" name="mentaldis" value="无">无</label>
      <label><input type="radio" name="mentaldis" value="精神分裂症">精神分裂症</label>
      <label><input type="radio" name="mentaldis" value="双相情感障碍">双相情感障碍</label>
      <label><input type="radio" name="mentaldis" value="偏执性精神障碍">偏执性精神障碍</label>
      <label><input type="radio" name="mentaldis" value="分裂情感性障碍">分裂情感性障碍</label>
      <label><input type="radio" name="mentaldis" value="癫痫所致精神障碍">癫痫所致精神障碍</label>
      <label><input type="radio" name="mentaldis" value="精神发育迟滞伴发精神障碍">精神发育迟滞伴发精神障碍</label>
    </div>
    <label for="chronic">(3)慢性疾病</label>
    <input type="text" id="chronic" name="chronic" required>
    <label for="fall">(4)跌倒</label>
    <div id="fall">
      <label><input type="radio" name="fall" value="无">无</label>
      <label><input type="radio" name="fall" value="发生过 1 次">发生过 1 次</label>
      <label><input type="radio" name="fall" value="发生过 2 次">发生过 2 次</label>
      <label><input type="radio" name="fall" value="发生过 3 次及以上">发生过 3 次及以上</label>
    </div>
    <label for="lost">(5)走失</label>
    <div id="lost">
      <label><input type="radio" name="lost" value="无">无</label>
      <label><input type="radio" name="lost" value="发生过 1 次">发生过 1 次</label>
      <label><input type="radio" name="lost" value="发生过 2 次">发生过 2 次</label>
      <label><input type="radio" name="lost" value="发生过 3 次及以上">发生过 3 次及以上</label>
    </div>
    <label for="choke">(6)噎食</label>
    <div id="choke">
      <label><input type="radio" name="choke" value="无">无</label>
      <label><input type="radio" name="choke" value="发生过 1 次">发生过 1 次</label>
      <label><input type="radio" name="choke" value="发生过 2 次">发生过 2 次</label>
      <label><input type="radio" name="choke" value="发生过 3 次及以上">发生过 3 次及以上</label>
    </div>
    <label for="suicide">(7)自杀</label>
    <div id="suicide">
      <label><input type="radio" name="suicide" value="无">无</label>
      <label><input type="radio" name="suicide" value="发生过 1 次">发生过 1 次</label>
      <label><input type="radio" name="suicide" value="发生过 2 次">发生过 2 次</label>
      <label><input type="radio" name="suicide" value="发生过 3 次及以上">发生过 3 次及以上</label>
    </div>
    <label for="else">(8)其他</label>
    <input type="text" id="else" name="else" required>
    <h2>三、信息提供者及联系人信息表</h2>
    <label for="proname">1.信息提供者的姓名</label>
    <input type="text" id="proname" name="proname" required>
    <label for="relation">2.信息提供者与老人的关系</label>
    <div id="relation">
      <label><input type="radio" name="relation" value="配偶">配偶</label>
      <label><input type="radio" name="relation" value="子女">子女</label>
      <label><input type="radio" name="relation" value="其他亲属">其他亲属</label>
      <label><input type="radio" name="relation" value="雇佣照顾者">雇佣照顾者</label>
      <label><input type="radio" name="relation" value="其他">其他</label>
    </div>
    <label for="conname">3.联系人姓名</label>
    <input type="text" id="conname" name="conname" required>
    <label for="conphone">4.联系人电话</label>
    <input type="text" id="conphone" name="conphone" required>

    <button type="submit">提交后开始测试</button>
  </form>
  <div>
    <a href="index.html">
      <button>返回主界面</button>
    </a>
  </div>
</div>
</body>
<script>
  document.getElementById("addForm").addEventListener("submit", function (event) {
    event.preventDefault();
    const id = document.getElementById("num").value;
    localStorage.setItem('id',id);
    const thedate = document.getElementById("thedate");
    const reason =document.querySelectorAll('input[name=reason]');
    let r;
    reason.forEach(radio => {
      if (radio.checked) {
        r= radio.value;
      }
    });
    const name=document.getElementById("name").value;
    localStorage.setItem('name',name);

    fetch("basic/add1",{
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        id:id,
        date:thedate.value,
        reason:r,
        name:name,
      })
    })
            .then(res => res.json())
            .then(data => {
              if (data.msg === 'success') {
                alert("提交成功");
                console.log(data);
                location.href="assessmentB1.html";
              } else{
                alert("提交失败(a1)");
              }
            })
            .catch(error => {
              alert("请求失败，请重试(a1)");
              console.error(error);
            });

    const sex = document.querySelectorAll('input[name=sex]');
    let s;
    sex.forEach(radio => {
      if (radio.checked) {
        s= radio.value;
      }
    });
    const born =document.getElementById("born");
    const idcard = document.getElementById("idcard");
    const socialcard = document.getElementById("socialcard");
    const nation = document.getElementById("nation");
    const education =document.querySelectorAll('input[name=education]');
    let e;
    education.forEach(radio => {
      if (radio.checked) {
        e= radio.value;
      }
    });
    const religion = document.getElementById("religion");
    const marriage =document.querySelectorAll('input[name=marriage]');
    let m;
    marriage.forEach(radio => {
      if (radio.checked) {
        m= radio.value;
      }
    });
    const resident =document.querySelectorAll('input[name=resident]');
    let re;
    resident.forEach(radio => {
      if (radio.checked) {
        re= radio.value;
      }
    });
    const medical =document.querySelectorAll('input[name=medical]');
    let me;
    medical.forEach(radio => {
      if (radio.checked) {
        me= radio.value;
      }
    });
    const income =document.querySelectorAll('input[name=income]');
    let i;
    income.forEach(radio => {
      if (radio.checked) {
        i= radio.value;
      }
    });
    const stupid =document.querySelectorAll('input[name=stupid]');
    let st;
    stupid.forEach(radio => {
      if (radio.checked) {
        st= radio.value;
      }
    });
    const mentaldis =document.querySelectorAll('input[name=mentaldis]');
    let men;
    mentaldis.forEach(radio => {
      if (radio.checked) {
        men= radio.value;
      }
    });
    const chronic=document.getElementById("chronic");
    const fall =document.querySelectorAll('input[name=fall]');
    let f;
    fall.forEach(radio => {
      if (radio.checked) {
        f= radio.value;
      }
    });
    const lost =document.querySelectorAll('input[name=lost]');
    let l;
    lost.forEach(radio => {
      if (radio.checked) {
        l= radio.value;
      }
    });
    const choke =document.querySelectorAll('input[name=choke]');
    let c;
    choke.forEach(radio => {
      if (radio.checked) {
        c= radio.value;
      }
    });
    const suicide =document.querySelectorAll('input[name=suicide]');
    let su;
    suicide.forEach(radio => {
      if (radio.checked) {
        su= radio.value;
      }
    });
    const elseill =document.getElementById("else")

    fetch("basic/add2",{
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        name:name,
        sex:s,
        born:born.value,
        idcard:idcard.value,
        socialcard:socialcard.value,
        nation:nation.value,
        education:e,
        religion:religion.value,
        marriage:m,
        resident:re,
        medical:me,
        income:i,
        stupid:st,
        mentaldis:men,
        chronic:chronic.value,
        fall:f,
        lost:l,
        choke:c,
        suicide:su,
        elseill:elseill.value,
      })
    })
            .then(res => res.json())
            .then(data => {
              if (data.msg === 'success') {
                alert("提交成功");
                console.log(data);
              } else{
                alert("提交失败(a2)");
              }
            })
            .catch(error => {
              alert("请求失败，请重试(a2)");
              console.error(error);
            });

    const eldername=document.getElementById("name");
    const providername=document.getElementById("proname");
    const relation =document.querySelectorAll('input[name=relation]');
    let rel;
    relation.forEach(radio => {
      if (radio.checked) {
        rel= radio.value;
      }
    });
    const contactname=document.getElementById("conname");
    const contactphone=document.getElementById("conphone");

    fetch("basic/add",{
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        eldername:eldername.value,
        providername:providername.value,
        relation:rel,
        contactname:contactname.value,
        contactphone:contactphone.value,
      })
    })
            .then(res => res.json())
            .then(data => {
              if (data.msg === 'success') {
                alert("提交成功");
                console.log(data);
              } else{
                alert("提交失败(a3)");
              }
            })
            .catch(error => {
              alert("请求失败，请重试(a3)");
              console.error(error);
            });
  });
</script>
<script>
  function toggleMedelse() {
    var medelseInput = document.getElementById('medelse');
    var otherRadio = document.querySelector('input[name="medical"][value=""]');
    if (otherRadio.checked) {
      medelseInput.disabled = false;
    } else {
      medelseInput.disabled = true;
      medelseInput.value = '';
    }
  }

  function handleSubmit(event) {
    event.preventDefault();
    var medelseInput = document.getElementById('medelse');
    var otherRadio = document.querySelector('input[name="medical"][value=""]');
    if (otherRadio.checked) {
      otherRadio.value = medelseInput.value;
    }
  }
  function toggleIncelse() {
    var incelseInput = document.getElementById('incelse');
    var otherRadio = document.querySelector('input[name="income"][value="其他"]');
    if (otherRadio.checked) {
      incelseInput.disabled = false;
    } else {
      incelseInput.disabled = true;
    }
  }

  function IncSubmit(event) {
    event.preventDefault();
    var incelseInput = document.getElementById('incelse');
    var otherRadio = document.querySelector('input[name="income"][value="其他"]');
    if (otherRadio.checked) {
      otherRadio.value = incelseInput.value;
    }
  }
  function All(event) {
    handleSubmit(event);
    IncSubmit(event);
  }
</script>
</html>